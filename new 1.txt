#include "imgui.h"
#include <stack>
template <auto Fn, auto... Args>
struct ImSG
{
bool enabled;
ImSG(){}
ImSG(const ImSG&) = delete;
ImSG& operator=(const ImSG&) = delete;
ImSG(ImSG&& other)
{
other.enabled = false;
}
ImSG& operator = (ImSG&& other)
{
other.enabled = false;
return (*this);
}
~ImSG()
{
if (enabled)
{
Fn(Args...);
}
}
}

template <typename... T>
struct ImScoped
{
std::tuple<T...> valT;
ImScoped(T&&... val) : valT{std::forward<T>(valT)...} {}
}

template <auto Fn>
struct ImGuiScopedWindow
{
bool skipItems;
ImScoped<Fn> guard;
ImGuiScopedWindow(bool skip) : skipItems{skip} {}
inline operator bool()
{
return skipItems;
}
~ImGuiScopedWindow() = delete;
}

struct ImGuiScopedWindowStack
{
	ImGuiWindow* lastWindow;
	std::stack<ImGuiScopedWindowStack> ws;
	using stuff = std::function<void(void)>;
	ImGuiScopedWindowStack(ImGuiScopedWindow&& sw, stuff s)
	{
		lastWindow = ImGui::GetCurrentWindow();
		if (ws.emplace(std::move(sw)))
		{
		s();
		}
		ws.pop();
	}
}